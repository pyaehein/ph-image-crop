var cropButton=$(".crop-button"),cropImage=$("#crop-image"),removeButton=$(".remove-button"),imageFile=$(".image-file"),cropModal=$("#ph-image-crop-modal"),imgThumbnail=$(".ph-thumbnail"),currentImage,currentInput,currentRatio=1,currentWidth=1,currentHeight=1;$(document).ready(function(){removeButton.on("click",function(){$(this).siblings("label").children(".image-file").val(""),$(this).parent().siblings(".ph-img-thumbnail").children(".ph-thumbnail").attr("src",""),$(this).hide(),$(this).parent().siblings(".ph-img-thumbnail").children(".old-thumbnail").show(),$(this).siblings("label").children(".select-image").show(),$(this).siblings("label").children(".change-image").hide(),$(this).siblings(".crop-button").hide()}),imgThumbnail.on("load",function(){$(this).siblings(".old-thumbnail").hide()}),cropButton.on("click",function(){cropImage.attr("src",$(this).parent().siblings(".ph-img-thumbnail").children(".base-thumbnail").attr("src")),currentImage=$(this).parent().siblings(".ph-img-thumbnail").children(".ph-thumbnail"),currentInput=$(this).parent().siblings(".ph-img-thumbnail").children(".ph-image"),currentRatio=$(this).parent().parent().attr("data-ratio"),currentWidth=$(this).parent().parent().attr("data-width"),currentHeight=$(this).parent().parent().attr("data-height"),cropModal.modal("show")}),imageFile.on("change",function(){var t=$(this);t.siblings(".change-image").show(),t.siblings(".select-image").hide(),t.parent().siblings(".crop-button").show(),t.parent().siblings(".remove-button").show();var i=t[0].files[0],e=new FileReader;e.addEventListener("load",function(){cropImage.attr("src",e.result),t.parent().parent().siblings(".ph-img-thumbnail").children(".base-thumbnail").attr("src",e.result)},!1),i&&e.readAsDataURL(i),currentImage=$(this).parent().parent().siblings(".ph-img-thumbnail").children(".ph-thumbnail"),currentInput=$(this).parent().parent().siblings(".ph-img-thumbnail").children(".ph-image"),currentRatio=$(this).parent().parent().parent().attr("data-ratio"),currentWidth=$(this).parent().parent().parent().attr("data-width"),currentHeight=$(this).parent().parent().parent().attr("data-height"),cropModal.modal("show")}),cropModal.on("shown.bs.modal",function(){cropImage.cropper({aspectRatio:eval(currentRatio),minCropBoxWidth:eval(currentWidth),minCropBoxHeight:eval(currentHeight)})}).on("hidden.bs.modal",function(){var t=cropImage.cropper("getCroppedCanvas").toDataURL("image/jpeg");currentImage.attr("src",t),currentInput.val(t),cropImage.cropper("destroy")})});